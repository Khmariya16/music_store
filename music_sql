
--Moderate Questions

--Q1 Find the total number of tracks for each genre.

SELECT genre.name, COUNT(track.track_id) AS total_tracks 
FROM track 
JOIN genre ON track.genre_id = genre.genre_id 
GROUP BY genre.name;

--Q2 Find the top 5 most expensive tracks in the database.

select name , unit_price
from track
order by unit_price desc
limit 5

--Q3 Get the total revenue generated by each media type.

select media_type.name , sum(invoice_line.unit_price * invoice_line.quantity) as total_revenue
from invoice_line
join track on invoice_line.track_id = track.track_id
join media_type on track.media_type_id = media_type.media_type_id
group by media_type.name

--Q4 list all employees who report to a specific manager

select e1.employee_id , e1.first_name , e1.last_name
from employee e1 
join employee e2 on e1.reports_to = e2.employee_id
where e2.first_name = 'Nancy'

--Q5 Find the customer who has made the highest total purchase.

SELECT customer.customer_id, customer.first_name, customer.last_name, 
       SUM(invoice.total) AS total_spent
FROM customer
JOIN invoice ON customer.customer_id = invoice.customer_id
GROUP BY customer.customer_id
ORDER BY total_spent DESC
LIMIT 1;
